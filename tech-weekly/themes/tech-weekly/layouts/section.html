{{ define "main" }}
  <h1 class="hidden-title">{{ .Title }}</h1>
  {{ partial "quote.html" . }}
  {{ if ne .Section "about" }}
    {{ partial "tag-filter.html" . }}
  {{ end }}
  {{ .Content }}
  <div class="grid" id="grid">
    {{ $pages := .Pages }}
    {{ $sec := .Section }}
     {{ if and (eq (len $pages) 0) $sec }}{{ $pages = where (where .Site.Pages "Kind" "page") "Section" $sec }}{{ end }}
     {{/* DEBUG: show counts */}}
     <div class="debug" style="display:none">pages={{ len $pages }}, regular={{ len .Site.RegularPages }}, pagesAll={{ len .Site.Pages }}, weeklyReg={{ len (where .Site.RegularPages "Section" "weekly") }}, weeklyAll={{ len (where .Site.Pages "Section" "weekly") }}</div>
     {{ range $pages.ByDate.Reverse }}
      <article class="card" data-tags="{{ delimit (.Params.tags | default (slice)) "," }}">
        <h2><a href="{{ .RelPermalink }}">{{ .LinkTitle }}</a></h2>
        <div class="meta"><i class="ri-calendar-line icon"></i>{{ .Date | time.Format ":date_medium" }}</div>
        <p>{{ .Summary }}</p>
        {{ partial "terms.html" (dict "taxonomy" "tags" "page" .) }}
         <a class="stretched-link" href="{{ .RelPermalink }}"></a>
       </article>
    {{ end }}
  </div>
{{ end }}
